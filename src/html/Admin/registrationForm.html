<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RegistrationForm</title>
    <link rel="stylesheet" href="../../../dist/output.css" />
</head>

<body>
    <section class="py-10 px-20 flex justify-center items-center">
        <div class="border-black border w-full">
            <form class="p-4" id="myForm">
                <div class="flex gap-6 w-full">
                    <div class="flex flex-col mt-4 w-full">
                        <label for="firstName" class="block text-sm font-medium text-gray-700">First Name</label>
                        <input type="text" name="firstName" id="firstName" placeholder="Enter FirstName"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" />
                        <div id="firstNameError" class="text-red-600 opacity-0">Name should be alphabet </div>
                    </div>
                    <div class="flex flex-col mt-4 w-full">
                        <label for="lastName" class="block text-sm font-medium text-gray-700">Last Name</label>
                        <input type="text" name="lastName" id="lastName" placeholder="Enter LastName"
                            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" />
                        <div id="lastNameError" class="text-red-600 opacity-0">Last should be alphabet</div>
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="age">Age:</label>
                    <input type="number" id="age" name="age"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        placeholder="Enter your age" />
                    <div id="ageError" class="text-red-600 opacity-0">Age should be greater than 18 or equal</div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="gender">Gender:</label>
                    <select id="gender" name="gender"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="">Select your gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                    <div id="genderError" class="text-red-600 opacity-0">Please select gender</div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="email">Email:</label>
                    <input type="email" id="email" name="email"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        placeholder="Enter your email address" />
                    <div id="emailError" class="text-red-600 opacity-0">Please enter valid email with @ and . </div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="date_of_birth">Date of Birth:</label>
                    <input type="date" id="date_of_birth" name="date_of_birth"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
                        placeholder="YYYY-MM-DD" />
                    <div id="date_of_birthError" class="text-red-600 opacity-0">please select Date of birth</div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="blood_group">Blood Group:</label>
                    <select id="blood_group" name="blood_group"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="">Select your blood group</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                    <div id="blood_groupError" class="text-red-600 opacity-0">please select blood group</div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="image">Upload Image:</label>
                    <input type="file" id="image" name="image"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" />
                    <div id="imageError" class="text-red-600 opacity-0">please choose image</div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="phone_number">Phone Number:</label>
                    <input type="tel" id="phone_number" name="phone_number"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" />
                    <div id="phone_numberError" class="text-red-600 opacity-0">please enter 10 digit number</div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="current_address">Current
                        Address:</label>
                    <textarea id="current_address" name="current_address"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                    <div id="current_addressError" class="text-red-600 opacity-0">please enter your current address
                    </div>
                </div>

                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="permanent_address">Permanent
                        Address:</label>
                    <div class="flex items-center">
                        <input type="checkbox" id="same_as_current" class="mr-2" />
                        <label for="same_as_current" class="text-gray-700">Same as current address</label>
                    </div>
                    <textarea id="permanent_address" name="permanent_address"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                    <div id="permanent_addressError" class="text-red-600 opacity-0">please enter your permanent address
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-700 text-sm font-bold mb-2">Select your role:</label>
                    <select id="role" name="role"
                        class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="">Please select...</option>
                        <option value="admin">Admin</option>
                        <option value="hr">HR</option>
                        <option value="employee">Employee</option>
                    </select>
                    <div id="roleError" class="text-red-600 opacity-0">please select your role</div>
                </div>
                <div class="flex justify-center">
                    <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                        Submit
                    </button>
                </div>
            </form>
        </div>
    </section>
    <script>
        (function () {

            const user = {
                // form
                form: document.getElementById("myForm"),
                // form
                firstName: document.getElementById("firstName"),
                lastName: document.getElementById("lastName"),
                age: document.getElementById("age"),
                gender: document.getElementById("gender"),
                email: document.getElementById("email"),
                date_of_birth: document.getElementById("date_of_birth"),
                blood_group: document.getElementById("blood_group"),
                image: document.getElementById("image"),
                phone: document.getElementById("phone_number"),
                current_address: document.getElementById("current_address"),
                checkBoxBtn: document.getElementById('same_as_current'),
                permanent_address: document.getElementById("permanent_address"),
                role: document.getElementById("role"),

                notesStorage: localStorage.getItem("notes") ? JSON.parse(localStorage.getItem("notes")) : [],

                updateStorage: function () {
                    localStorage.setItem("notes", JSON.stringify(this.notesStorage));
                },
                error: {
                    firstNameError: document.getElementById("firstNameError"),
                    lastNameError: document.getElementById("lastNameError"),
                    ageError: document.getElementById("ageError"),
                    genderError: document.getElementById("genderError"),
                    emailError: document.getElementById("emailError"),
                    date_of_birthError: document.getElementById("date_of_birthError"),
                    blood_groupError: document.getElementById("blood_groupError"),
                    imageError: document.getElementById("imageError"),
                    phoneError: document.getElementById("phone_numberError"),
                    current_addressError: document.getElementById("current_addressError"),
                    permanent_addressError: document.getElementById("permanent_addressError"),
                    roleError: document.getElementById("roleError"),
                },
                getFileBase64: function (file) {
                    return new Promise((Resolve, Reject) => {
                        const fileReader = new FileReader()
                        fileReader.onload = () => {
                            Resolve(fileReader.result)
                        }
                        fileReader.onerror = () => {
                            Reject("")
                        }
                        fileReader.readAsDataURL(file)
                    })
                },
                bind: function () {

                    this.firstName.addEventListener('blur', () => {
                        if (!/^[a-zA-Z]+$/.test(this.firstName.value)) {
                            this.error.firstNameError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.firstNameError.classList.add('opacity-0')
                        }
                    })

                    this.lastName.addEventListener('blur', () => {
                        if (!/^[a-zA-Z]+$/.test(this.lastName.value)) {
                            this.error.lastNameError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.lastNameError.classList.add('opacity-0')
                        }
                    })
                    this.age.addEventListener('blur', () => {
                        if (this.age.value.trim() <= 18) {
                            this.error.ageError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.ageError.classList.add('opacity-0')
                        }
                    })
                    this.gender.addEventListener('blur', () => {
                        if (this.gender.value.trim() == '') {
                            this.error.genderError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.genderError.classList.add('opacity-0')
                        }
                    })

                    this.email.addEventListener('blur', () => {
                        if (!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(this.email.value.trim())) {
                            this.error.emailError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.emailError.classList.add('opacity-0')
                        }
                    })
                    this.date_of_birth.addEventListener('blur', () => {
                        if (this.date_of_birth.value.trim() == '') {
                            this.error.date_of_birthError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.date_of_birthError.classList.add('opacity-0')
                        }
                    })
                    this.blood_group.addEventListener('blur', () => {
                        if (this.blood_group.value.trim() == '') {
                            this.error.blood_groupError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.blood_groupError.classList.add('opacity-0')
                        }
                    })
                    this.image.addEventListener('blue', () => {
                        if (this.image.value.trim() == '') {
                            this.error.imageError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.imageError.classList.add('opacity-0')
                        }
                    })
                    this.phone.addEventListener('blur', () => {
                        if (!/^[6-9]\d{9}$/.test(this.phone.value)) {
                            this.error.phoneError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.phoneError.classList.add('opacity-0')
                        }
                    })
                    this.current_address.addEventListener('blur', () => {
                        if (this.current_address.value.trim() == '') {
                            this.error.current_addressError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.current_addressError.classList.add('opacity-0')
                        }
                    })
                    this.permanent_address.addEventListener('blur', () => {
                        if (this.permanent_address.value.trim() == '') {
                            this.error.permanent_addressError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.permanent_addressError.classList.add('opacity-0')
                        }
                    })
                    this.role.addEventListener('blur', () => {
                        if (this.role.value.trim() == '') {
                            this.error.roleError.classList.remove('opacity-0')
                        }
                        else {
                            this.error.roleError.classList.add('opacity-0')
                        }
                    })
                    // submit form here

                    this.form.addEventListener("submit", async (event) => {
                        event.preventDefault();

                        const formData = new FormData(this.form);
                        const user = Object.fromEntries(formData)
                        user.id = Date.now()

                        const profileUrl = await getFileBase64(user.image)
                        console.log(profileUrl);

                        

                        // if (
                        //     /^[a-zA-Z]+$/.test(this.firstName.value) &&
                        //     /^[a-zA-Z]+$/.test(this.lastName.value) &&
                        //     this.age.value > 18 &&
                        //     this.gender.value != '' &&
                        //     /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(this.email.value.trim()) &&
                        //     this.date_of_birth.value.trim() !== '' &&
                        //     this.blood_group.value.trim() !== '' &&
                        //     this.image.value.trim() !== '' &&
                        //     /^[6-9]\d{9}$/.test(this.phone.value) &&
                        //     this.current_address.value.trim() !== '' &&
                        //     this.permanent_address.value.trim() !== '' &&
                        //     this.role.value.trim() !== ''
                        // ) {


                        //     let formDataStorage = {};

                        //     formDataStorage.id = Date.now();
                        //     formlocalStorage.forEach((value, key) => {
                        //         async function processFormData(value, key) {
                        //             if (key === 'image' && value instanceof File) {
                        //                 return new Promise((resolve, reject) => {
                        //                     const selectedFile = new FileReader();

                        //                     selectedFile.readAsDataURL(value);

                        //                     selectedFile.onload = (e) => {
                        //                         formDataStorage[key] = selectedFile.result;
                        //                         resolve();
                        //                     };

                        //                     selectedFile.onerror = (error) => {
                        //                         reject(error);
                        //                     };
                        //                 });
                        //             } else {
                        //                 if (value.trim() !== '') {
                        //                     formDataStorage[key] = value;
                        //                     return Promise.resolve();
                        //                 } else {
                        //                     return Promise.resolve();
                        //                 }
                        //             }
                        //         }

                        //     });

                        //     this.notesStorage.push(formDataStorage);
                        //     console.log(this.notesStorage);
                        //     // localStorage.setItem("notes", JSON.stringify(this.notesStorage));
                        //     this.updateStorage()
                        //     window.location.href = 'Admin.html';
                        //     // document.getElementById('myForm').reset()
                        // }
                        // else {
                        //     alert('Please fill all fields')
                        // }
                    });
                },
            };
            user.bind();
            // user.render()

        })();
    </script>
</body>

</html>